<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Word Finder | Ø§Ø¨Ø­Ø« Ø¹Ù† Ø§Ù„ÙƒÙ„Ù…Ø©</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @font-face {
            font-family: 'AA-Galaxy'; 
            src: url('AA-GALAXY.woff2') format('woff2');
            font-weight: normal; font-style: normal;
        }

        :root {
            --notebook-bg: #fdf6e3; 
            --border-main: #8b4513; 
            --feedback-green: #6B8E23;
            --feedback-yellow: #DAA520;
            --feedback-gray: #9e8a78;
        }

        .font-ar { font-family: 'AA-Galaxy', serif !important; }
        .font-en { font-family: ui-sans-serif, system-ui, sans-serif !important; }

        body {
            background: linear-gradient(-45deg, #ee7752, #e73c7e, #23a6d5, #23d5ab);
            background-size: 400% 400%;
            animation: gradientBG 15s ease infinite;
            min-height: 100vh;
            display: flex; flex-direction: column; align-items: center; padding: 20px;
        }

        @keyframes gradientBG {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        .app-container {
            background: var(--notebook-bg);
            border: 3px solid var(--border-main);
            border-radius: 15px;
            width: 100%; max-width: 450px; padding: 25px;
            box-shadow: 10px 10px 0px rgba(0,0,0,0.2);
        }

        .sketch-button {
            background: var(--border-main); color: white;
            padding: 12px; border-radius: 8px; font-weight: bold;
            width: 100%; cursor: pointer; border-bottom: 4px solid #4b250a;
            transition: all 0.1s; text-align: center;
        }

        .letter-box {
            width: 42px; height: 48px; border: 2px solid var(--border-main);
            display: flex; justify-content: center; align-items: center;
            font-size: 1.5rem; font-weight: bold; border-radius: 6px;
            background: rgba(255,255,255,0.5);
        }

        .keyboard-key {
            background: #eaddc5; border: 1px solid var(--border-main);
            border-radius: 5px; padding: 12px 4px; margin: 2px;
            min-width: 32px; cursor: pointer; font-weight: bold; flex: 1;
            text-align: center; font-size: 1rem; transition: 0.2s;
        }

        .correct { background: var(--feedback-green) !important; color: white; }
        .present { background: var(--feedback-yellow) !important; color: white; }
        .absent { 
            background: var(--feedback-gray) !important; 
            color: rgba(255,255,255,0.5); 
            opacity: 0.4; 
            cursor: not-allowed !important; 
            transform: scale(0.95);
        }
    </style>
</head>
<body class="font-ar" id="body-tag">

    <div class="mb-6 flex gap-3">
        <button onclick="setUILang('ar')" id="ui-ar" class="bg-white/90 px-5 py-2 rounded-full shadow-lg font-bold border-2 border-main">Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©</button>
        <button onclick="setUILang('en')" id="ui-en" class="bg-white/90 px-5 py-2 rounded-full shadow-lg font-bold border-2 border-transparent">English</button>
    </div>

    <div class="app-container">
        <div id="setup-screen" class="space-y-6">
            <h1 id="txt-title" class="text-3xl font-bold text-center border-b-2 border-dashed border-main pb-2">Ø§Ø¨Ø­Ø« Ø¹Ù„Ù‰ Ø§Ù„ÙƒÙ„Ù…Ø©</h1>
            
            <div class="flex gap-2">
                <button id="mode-m" onclick="setMode('manual')" class="flex-1 p-3 rounded-lg border-2 border-main bg-white font-bold">âœï¸ <span id="txt-m">ÙŠØ¯ÙˆÙŠ</span></button>
                <button id="mode-r" onclick="setMode('robot')" class="flex-1 p-3 rounded-lg border-2 border-main bg-white font-bold">ğŸ¤– <span id="txt-r">ØªÙ„Ù‚Ø§Ø¦ÙŠ</span></button>
            </div>

            <div id="manual-settings" class="space-y-4">
                <div>
                    <label id="txt-label-word" class="block font-bold mb-1">Ø§Ù„ÙƒÙ„Ù…Ø© Ø§Ù„Ø³Ø±ÙŠØ©:</label>
                    <input type="password" id="secret-input" class="w-full p-3 border-2 border-main rounded-md bg-white/50" placeholder="...">
                </div>
                <div>
                    <label id="txt-label-att" class="block font-bold mb-1">Ø¹Ø¯Ø¯ Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø§Øª (0 Ù„Ù„Ù…Ø§Ù„Ø§ Ù†Ù‡Ø§ÙŠØ©):</label>
                    <input type="number" id="attempts-input" value="6" min="0" max="20" class="w-full p-3 border-2 border-main rounded-md bg-white/50">
                </div>
            </div>

            <div id="robot-settings" class="hidden text-center space-y-4">
                <p id="txt-robot-desc" class="font-bold">Ø³Ø£Ø®ØªØ§Ø± Ù„Ùƒ ÙƒÙ„Ù…Ø© Ø¹Ø´ÙˆØ§Ø¦ÙŠØ©!</p>
                <div class="flex justify-center gap-4">
                    <button id="rl-ar" onclick="setRobotLang('ar')" class="px-6 py-2 rounded-full border-2 border-main bg-white font-bold">Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©</button>
                    <button id="rl-en" onclick="setRobotLang('en')" class="px-6 py-2 rounded-full border-2 border-main bg-white font-bold">English</button>
                </div>
            </div>

            <button onclick="startGame()" id="txt-btn-start" class="sketch-button text-lg">Ø¨Ø¯Ø¡ Ø§Ù„Ù„Ø¹Ø¨</button>
        </div>

        <div id="game-screen" class="hidden space-y-4">
            <div class="text-center">
                <p id="txt-tries-left" class="text-lg font-bold text-red-700"></p>
            </div>
            <div id="grid-container" class="space-y-2 max-h-64 overflow-y-auto"></div>
            <div id="input-row" class="flex justify-center gap-1 my-6"></div>
            <button onclick="submitGuess()" id="txt-btn-guess" class="sketch-button">ØªØ­Ù‚Ù‚</button>
            <div id="keyboard" class="flex flex-col gap-1 mt-4"></div>
        </div>
    </div>

    <script>
        const translations = {
            ar: {
                title: "Ø§Ø¨Ø­Ø« Ø¹Ù„Ù‰ Ø§Ù„ÙƒÙ„Ù…Ø©", m: "ÙŠØ¯ÙˆÙŠ", r: "ØªÙ„Ù‚Ø§Ø¦ÙŠ", labelWord: "Ø§Ù„ÙƒÙ„Ù…Ø© Ø§Ù„Ø³Ø±ÙŠØ©:", labelAtt: "Ø¹Ø¯Ø¯ Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø§Øª (0 Ù„Ù„Ø§Ù†Ù‡Ø§Ø¦ÙŠØ©):",
                robotDesc: "Ø³Ø£Ø®ØªØ§Ø± Ù„Ùƒ ÙƒÙ„Ù…Ø© Ø¹Ø´ÙˆØ§Ø¦ÙŠØ©!", btnStart: "Ø¨Ø¯Ø¡ Ø§Ù„Ù„Ø¹Ø¨", btnGuess: "ØªØ­Ù‚Ù‚",
                tries: "Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø§Øª Ø§Ù„Ù…ØªØ¨Ù‚ÙŠØ©: ", infinite: "ÙˆØ¶Ø¹ Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø§Øª Ø§Ù„Ù„Ø§Ù†Ù‡Ø§Ø¦ÙŠØ© â™¾ï¸", currentTry: "Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø© Ø±Ù‚Ù…: ",
                win: "Ù…Ø¨Ø±ÙˆÙƒ ÙØ²Øª! ğŸ‰", lose: "Ù„Ù„Ø£Ø³Ù Ø®Ø³Ø±Øª! Ø§Ù„ÙƒÙ„Ù…Ø© ÙƒØ§Ù†Øª: ",
                dir: "rtl", font: "font-ar"
            },
            en: {
                title: "Word Finder", m: "Manual", r: "AI Mode", labelWord: "Secret Word:", labelAtt: "Attempts (0 for infinite):",
                robotDesc: "I'll pick a word for you!", btnStart: "Start Game", btnGuess: "Check",
                tries: "Tries left: ", infinite: "Infinite Mode â™¾ï¸", currentTry: "Attempt number: ",
                win: "You Won! ğŸ‰", lose: "Game Over! Word was: ",
                dir: "ltr", font: "font-en"
            }
        };

        let currentUI = 'ar';
        let currentMode = 'manual';
        let robotLang = 'ar';
        let secretWord = '';
        let maxTries = 6;
        let guesses = [];
        let currentGuess = [];
        let letterStates = {};

        function setUILang(l) {
            currentUI = l;
            const t = translations[l];
            document.getElementById('body-tag').className = t.font;
            document.getElementById('body-tag').dir = t.dir;
            document.getElementById('ui-ar').classList.toggle('bg-amber-700', l === 'ar');
            document.getElementById('ui-ar').classList.toggle('text-white', l === 'ar');
            document.getElementById('ui-en').classList.toggle('bg-amber-700', l === 'en');
            document.getElementById('ui-en').classList.toggle('text-white', l === 'en');
            
            document.getElementById('txt-title').textContent = t.title;
            document.getElementById('txt-m').textContent = t.m;
            document.getElementById('txt-r').textContent = t.r;
            document.getElementById('txt-label-word').textContent = t.labelWord;
            document.getElementById('txt-label-att').textContent = t.labelAtt;
            document.getElementById('txt-robot-desc').textContent = t.robotDesc;
            document.getElementById('txt-btn-start').textContent = t.btnStart;
            document.getElementById('txt-btn-guess').textContent = t.btnGuess;
            updateTriesDisplay();
        }

        function setMode(m) {
            currentMode = m;
            document.getElementById('manual-settings').classList.toggle('hidden', m === 'robot');
            document.getElementById('robot-settings').classList.toggle('hidden', m === 'manual');
            document.getElementById('mode-m').classList.toggle('bg-amber-100', m === 'manual');
            document.getElementById('mode-r').classList.toggle('bg-amber-100', m === 'robot');
        }

        function setRobotLang(l) {
            robotLang = l;
            document.getElementById('rl-ar').classList.toggle('bg-amber-100', l === 'ar');
            document.getElementById('rl-en').classList.toggle('bg-amber-100', l === 'en');
        }

        function updateTriesDisplay() {
            const t = translations[currentUI];
            if (maxTries === 0) {
                document.getElementById('txt-tries-left').textContent = t.infinite + " | " + t.currentTry + (guesses.length + 1);
            } else {
                const left = maxTries - guesses.length;
                document.getElementById('txt-tries-left').textContent = t.tries + left;
            }
        }

        function startGame() {
            if (currentMode === 'manual') {
                secretWord = document.getElementById('secret-input').value.toLowerCase().trim();
                maxTries = parseInt(document.getElementById('attempts-input').value);
                if (isNaN(maxTries)) maxTries = 6;
            } else {
                const listAR = ["ÙƒØªØ§Ø¨", "Ø³Ù…Ø§Ø¡", "Ù†ÙˆØ±", "ØªÙØ§Ø­", "Ù‚Ù„Ù…", "Ù…Ø¯Ø±Ø³Ø©", "Ø¨Ø­Ø±"];
                const listEN = ["apple", "bread", "cloud", "dance", "earth", "world", "house"];
                secretWord = (robotLang === 'en' ? listEN : listAR)[Math.floor(Math.random() * listAR.length)];
                maxTries = 6;
            }

            if (!secretWord) return;
            guesses = [];
            letterStates = {};
            currentGuess = new Array(secretWord.length).fill("");
            document.getElementById('setup-screen').classList.add('hidden');
            document.getElementById('game-screen').classList.remove('hidden');
            updateTriesDisplay();
            initGameUI(/^[a-zA-Z]+$/.test(secretWord));
        }

        function initGameUI(isEn) {
            const row = document.getElementById('input-row');
            row.innerHTML = '';
            for (let i = 0; i < secretWord.length; i++) {
                const b = document.createElement('div');
                b.className = `letter-box ${isEn ? 'font-en' : 'font-ar'}`;
                b.id = `box-${i}`;
                row.appendChild(b);
            }
            renderKeyboard(isEn);
        }

        function renderKeyboard(isEn) {
            const kb = document.getElementById('keyboard');
            kb.innerHTML = '';
            const layout = isEn ? [["Q","W","E","R","T","Y","U","I","O","P"], ["A","S","D","F","G","H","J","K","L"], ["Z","X","C","V","B","N","M","DEL"]] : [["Ø¶","Øµ","Ø«","Ù‚","Ù","Øº","Ø¹","Ù‡","Ø®","Ø­","Ø¬","Ø¯"], ["Ø´","Ø³","ÙŠ","Ø¨","Ù„","Ø§","Øª","Ù†","Ù…","Ùƒ","Ø·"], ["Ø¦","Ø¡","Ø¤","Ø±","Ù‰","Ø©","Ùˆ","Ø²","Ø¸","Ø°","Ù…Ø³Ø­"]];
            layout.forEach(row => {
                const rDiv = document.createElement('div');
                rDiv.className = "flex w-full justify-center";
                row.forEach(k => {
                    const btn = document.createElement('button');
                    const charStatus = letterStates[k.toLowerCase()];
                    btn.className = `keyboard-key ${isEn ? 'font-en' : 'font-ar'}`;
                    if(charStatus) btn.classList.add(charStatus);
                    btn.textContent = k;
                    btn.onclick = () => {
                        if (charStatus === 'absent') return;
                        if (k === 'DEL' || k === 'Ù…Ø³Ø­') {
                            const idx = currentGuess.findLastIndex(c => c !== "");
                            if (idx !== -1) { currentGuess[idx] = ""; document.getElementById(`box-${idx}`).textContent = ""; }
                        } else {
                            const idx = currentGuess.indexOf("");
                            if (idx !== -1) { currentGuess[idx] = k.toLowerCase(); document.getElementById(`box-${idx}`).textContent = k; }
                        }
                    };
                    rDiv.appendChild(btn);
                });
                kb.appendChild(rDiv);
            });
        }

        function submitGuess() {
            if (currentGuess.includes("")) return;
            const guessStr = currentGuess.join('');
            const res = new Array(secretWord.length).fill('absent');
            const sArr = secretWord.split('');

            currentGuess.forEach((c, i) => {
                if (c === sArr[i]) { res[i] = 'correct'; sArr[i] = null; letterStates[c] = 'correct'; }
            });
            currentGuess.forEach((c, i) => {
                if (res[i] === 'absent' && sArr.includes(c)) {
                    res[i] = 'present'; sArr[sArr.indexOf(c)] = null;
                    if (letterStates[c] !== 'correct') letterStates[c] = 'present';
                } else if (res[i] === 'absent') {
                    if (!letterStates[c]) letterStates[c] = 'absent';
                }
            });

            guesses.push({ word: guessStr, res });
            renderGrid();
            renderKeyboard(/^[a-zA-Z]+$/.test(secretWord));
            updateTriesDisplay();
            
            if (guessStr === secretWord) {
                alert(translations[currentUI].win);
                location.reload();
            } else if (maxTries !== 0 && guesses.length >= maxTries) {
                alert(translations[currentUI].lose + secretWord.toUpperCase());
                location.reload();
            }

            currentGuess.fill("");
            for (let i = 0; i < secretWord.length; i++) document.getElementById(`box-${i}`).textContent = "";
        }

        function renderGrid() {
            const container = document.getElementById('grid-container');
            container.innerHTML = '';
            const isEn = /^[a-zA-Z]+$/.test(secretWord);
            guesses.forEach(g => {
                const r = document.createElement('div');
                r.className = "flex justify-center gap-1";
                g.word.split('').forEach((char, i) => {
                    const b = document.createElement('div');
                    b.className = `letter-box ${g.res[i]} ${isEn ? 'font-en' : 'font-ar'}`;
                    b.textContent = char.toUpperCase();
                    r.appendChild(b);
                });
                container.appendChild(r);
            });
            container.scrollTop = container.scrollHeight;
        }

        setUILang('ar');
    </script>
</body>
</html>
