<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Word Finder</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @font-face {
            font-family: 'AA-Galaxy'; 
            src: url('AA-GALAXY.woff2') format('woff2');
            font-weight: normal; font-style: normal;
        }
        :root {
            --notebook-bg: #fdf6e3; 
            --border-main: #8b4513; 
            --feedback-green: #6B8E23;
            --feedback-yellow: #DAA520;
            --feedback-gray: #9e8a78;
        }
        .font-ar { font-family: 'AA-Galaxy', serif !important; }
        .font-en { font-family: 'Segoe UI', Tahoma, sans-serif !important; }

        body {
            background: #e5e7eb;
            min-height: 100vh;
            display: flex; flex-direction: column; align-items: center; padding: 20px;
        }
        .app-container {
            background: var(--notebook-bg);
            border: 3px solid var(--border-main);
            border-radius: 15px;
            width: 100%; max-width: 450px; padding: 25px;
            box-shadow: 8px 8px 0px rgba(0,0,0,0.1);
        }
        .sketch-button {
            background: var(--border-main); color: white;
            padding: 12px; border-radius: 8px; font-weight: bold;
            width: 100%; cursor: pointer; border-bottom: 4px solid #4b250a;
        }
        .active-mode { background: #8b4513 !important; color: white !important; }
        .letter-box {
            width: 40px; height: 45px; border: 2px solid var(--border-main);
            display: flex; justify-content: center; align-items: center;
            font-size: 1.5rem; font-weight: bold; border-radius: 6px;
        }
        .keyboard-key {
            background: #eaddc5; border: 1px solid var(--border-main);
            border-radius: 5px; padding: 10px 4px; margin: 2px;
            min-width: 32px; cursor: pointer; font-weight: bold; flex: 1;
        }
        .correct { background: var(--feedback-green) !important; color: white; }
        .present { background: var(--feedback-yellow) !important; color: white; }
        .absent { background: var(--feedback-gray) !important; color: white; opacity: 0.6; }
    </style>
</head>
<body class="font-ar" id="body-tag">

    <div class="app-container">
        <div id="setup-screen" class="space-y-6">
            <h1 id="txt-title" class="text-3xl font-bold text-center">Ø§Ø¨Ø­Ø« Ø¹Ù„Ù‰ Ø§Ù„ÙƒÙ„Ù…Ø©</h1>
            
            <div class="flex gap-2">
                <button id="mode-m" onclick="setGameMode('manual')" class="flex-1 p-3 rounded-lg border-2 border-main active-mode">âœï¸ <span id="txt-m">ÙŠØ¯ÙˆÙŠ</span></button>
                <button id="mode-r" onclick="setGameMode('robot')" class="flex-1 p-3 rounded-lg border-2 border-main bg-white">ğŸ¤– <span id="txt-r">ØªÙ„Ù‚Ø§Ø¦ÙŠ</span></button>
            </div>

            <div id="manual-settings" class="space-y-4">
                <input type="password" id="secret-input" class="w-full p-3 border-2 border-main rounded-md" placeholder="Ø£Ø¯Ø®Ù„ Ø§Ù„ÙƒÙ„Ù…Ø© Ø§Ù„Ø³Ø±ÙŠØ©...">
            </div>

            <div id="robot-settings" class="hidden text-center space-y-4">
                <p class="font-bold">Ø§Ø®ØªØ± Ù„ØºØ© Ø§Ù„ÙƒÙ„Ù…Ø© Ø§Ù„Ø¹Ø´ÙˆØ§Ø¦ÙŠØ©:</p>
                <div class="flex justify-center gap-4">
                    <button id="rl-ar" onclick="setRobotLanguage('ar')" class="px-6 py-2 rounded-full border-2 border-main active-mode">Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©</button>
                    <button id="rl-en" onclick="setRobotLanguage('en')" class="px-6 py-2 rounded-full border-2 border-main bg-white">English</button>
                </div>
            </div>

            <button onclick="startGame()" class="sketch-button text-lg">Ø¨Ø¯Ø¡ Ø§Ù„ØªØ­Ø¯ÙŠ</button>
        </div>

        <div id="game-screen" class="hidden space-y-4">
            <div id="grid-container" class="space-y-2"></div>
            <div id="input-row" class="flex justify-center gap-1 my-6"></div>
            <button onclick="submitGuess()" id="txt-btn-guess" class="sketch-button">Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„ØªØ®Ù…ÙŠÙ†</button>
            <div id="keyboard" class="flex flex-col gap-1 mt-4"></div>
        </div>
    </div>

    <script>
        let currentMode = 'manual';
        let robotLang = 'ar'; // Ø§Ù„Ù„ØºØ© Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠØ© Ù„Ù„Ø±ÙˆØ¨ÙˆØª
        let secretWord = '';
        let guesses = [];
        let currentGuess = [];
        let letterStates = {};

        const keysAR = [["Ø¶","Øµ","Ø«","Ù‚","Ù","Øº","Ø¹","Ù‡","Ø®","Ø­","Ø¬","Ø¯"], ["Ø´","Ø³","ÙŠ","Ø¨","Ù„","Ø§","Øª","Ù†","Ù…","Ùƒ","Ø·"], ["Ø¦","Ø¡","Ø¤","Ø±","Ù‰","Ø©","Ùˆ","Ø²","Ø¸","Ø°","Ù…Ø³Ø­"]];
        const keysEN = [["Q","W","E","R","T","Y","U","I","O","P"], ["A","S","D","F","G","H","J","K","L"], ["Z","X","C","V","B","N","M","DEL"]];

        function setGameMode(m) {
            currentMode = m;
            document.getElementById('manual-settings').classList.toggle('hidden', m === 'robot');
            document.getElementById('robot-settings').classList.toggle('hidden', m === 'manual');
            document.getElementById('mode-m').className = m === 'manual' ? 'flex-1 p-3 rounded-lg border-2 border-main active-mode' : 'flex-1 p-3 rounded-lg border-2 border-main bg-white';
            document.getElementById('mode-r').className = m === 'robot' ? 'flex-1 p-3 rounded-lg border-2 border-main active-mode' : 'flex-1 p-3 rounded-lg border-2 border-main bg-white';
        }

        // Ø¥ØµÙ„Ø§Ø­ Ø¯Ø§Ù„Ø© Ø§Ø®ØªÙŠØ§Ø± Ù„ØºØ© Ø§Ù„Ø±ÙˆØ¨ÙˆØª
        function setRobotLanguage(lang) {
            robotLang = lang;
            console.log("ØªÙ… Ø§Ø®ØªÙŠØ§Ø± Ù„ØºØ© Ø§Ù„Ø±ÙˆØ¨ÙˆØª:", robotLang);
            document.getElementById('rl-ar').className = lang === 'ar' ? 'px-6 py-2 rounded-full border-2 border-main active-mode' : 'px-6 py-2 rounded-full border-2 border-main bg-white';
            document.getElementById('rl-en').className = lang === 'en' ? 'px-6 py-2 rounded-full border-2 border-main active-mode' : 'px-6 py-2 rounded-full border-2 border-main bg-white';
        }

        function startGame() {
            if (currentMode === 'manual') {
                secretWord = document.getElementById('secret-input').value.toLowerCase().trim();
            } else {
                const listAR = ["ÙƒØªØ§Ø¨", "Ø³Ù…Ø§Ø¡", "Ù†ÙˆØ±", "ØªÙØ§Ø­", "Ù‚Ù„Ù…"];
                const listEN = ["apple", "bread", "cloud", "dance", "earth"];
                const pool = (robotLang === 'en') ? listEN : listAR;
                secretWord = pool[Math.floor(Math.random() * pool.length)];
            }

            if (!secretWord) return alert("Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¯Ø®Ø§Ù„ ÙƒÙ„Ù…Ø©!");

            currentGuess = new Array(secretWord.length).fill("");
            document.getElementById('setup-screen').classList.add('hidden');
            document.getElementById('game-screen').classList.remove('hidden');
            
            // Ø¶Ø¨Ø· Ø§Ù„Ø®Ø· Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ù„ØºØ© Ø§Ù„ÙƒÙ„Ù…Ø© Ø§Ù„Ø³Ø±ÙŠØ©
            const isEn = /^[a-zA-Z]+$/.test(secretWord);
            document.getElementById('body-tag').dir = isEn ? 'ltr' : 'rtl';

            initInputArea(isEn);
            renderKeyboard(isEn);
        }

        function initInputArea(isEn) {
            const row = document.getElementById('input-row');
            row.innerHTML = '';
            for (let i = 0; i < secretWord.length; i++) {
                const b = document.createElement('div');
                b.className = `letter-box ${isEn ? 'font-en' : 'font-ar'}`;
                b.id = `box-${i}`;
                row.appendChild(b);
            }
        }

        function renderKeyboard(isEn) {
            const kb = document.getElementById('keyboard');
            kb.innerHTML = '';
            const layout = isEn ? keysEN : keysAR;
            layout.forEach(row => {
                const rDiv = document.createElement('div');
                rDiv.className = "flex w-full justify-center";
                row.forEach(k => {
                    const btn = document.createElement('button');
                    btn.className = `keyboard-key ${isEn ? 'font-en' : 'font-ar'}`;
                    btn.textContent = k;
                    btn.onclick = () => {
                        if (k === 'DEL' || k === 'Ù…Ø³Ø­') {
                            const idx = currentGuess.findLastIndex(c => c !== "");
                            if (idx !== -1) { currentGuess[idx] = ""; document.getElementById(`box-${idx}`).textContent = ""; }
                        } else {
                            const idx = currentGuess.indexOf("");
                            if (idx !== -1) { currentGuess[idx] = k.toLowerCase(); document.getElementById(`box-${idx}`).textContent = k; }
                        }
                    };
                    rDiv.appendChild(btn);
                });
                kb.appendChild(rDiv);
            });
        }

        function submitGuess() {
            if (currentGuess.includes("")) return;
            const guessStr = currentGuess.join('');
            const res = new Array(secretWord.length).fill('absent');
            const sArr = secretWord.split('');

            currentGuess.forEach((c, i) => {
                if (c === sArr[i]) { res[i] = 'correct'; sArr[i] = null; }
            });
            currentGuess.forEach((c, i) => {
                if (res[i] === 'absent' && sArr.includes(c)) {
                    res[i] = 'present'; sArr[sArr.indexOf(c)] = null;
                }
            });

            guesses.push({ word: guessStr, res });
            renderGrid();
            currentGuess.fill("");
            for (let i = 0; i < secretWord.length; i++) document.getElementById(`box-${i}`).textContent = "";
            
            if (guessStr === secretWord) alert("Ù…Ø¨Ø±ÙˆÙƒ! ÙØ²Øª");
            else if (guesses.length >= 6) alert("Ø®Ø³Ø±Øª! Ø§Ù„ÙƒÙ„Ù…Ø© ÙƒØ§Ù†Øª: " + secretWord);
        }

        function renderGrid() {
            const container = document.getElementById('grid-container');
            container.innerHTML = '';
            const isEn = /^[a-zA-Z]+$/.test(secretWord);
            guesses.forEach(g => {
                const r = document.createElement('div');
                r.className = "flex justify-center gap-1";
                g.word.split('').forEach((char, i) => {
                    const b = document.createElement('div');
                    b.className = `letter-box ${g.res[i]} ${isEn ? 'font-en' : 'font-ar'}`;
                    b.textContent = char.toUpperCase();
                    r.appendChild(b);
                });
                container.appendChild(r);
            });
        }
    </script>
</body>
</html>
